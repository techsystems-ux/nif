/*! Elementor Pro Frontend - Functional Replacement for Static Sites */
!function () {
  "use strict";

  /* ------------------------------------------------------------------ */
  /*  Boot on DOMContentLoaded                                          */
  /* ------------------------------------------------------------------ */
  document.addEventListener("DOMContentLoaded", function () {
    initSmartMenus();
    initPopupCloseButtons();
    initStaticFormHandler();
  });

  /* ================================================================== */
  /*  1. SmartMenus on .elementor-nav-menu                              */
  /* ================================================================== */
  function initSmartMenus() {
    if (typeof jQuery === "undefined") return;
    var $ = jQuery;

    /* Only proceed if SmartMenus jQuery plugin is loaded */
    if (typeof $.fn.smartmenus !== "function") return;

    $(".elementor-nav-menu").each(function () {
      var $menu = $(this);

      /* Skip if already initialised */
      if ($menu.data("smartmenus-id")) return;

      $menu.smartmenus({
        subMenusSubOffsetX: 1,
        subMenusSubOffsetY: -8,
        showFunction: function ($ul, complete) { $ul.slideDown(200, complete); },
        hideFunction: function ($ul, complete) { $ul.slideUp(200, complete); },
        showTimeout: 100,
        hideTimeout: 200
      });
    });

    /* -------- Mobile / responsive menu toggle -------- */
    $(document).on("click", ".elementor-menu-toggle", function (e) {
      e.preventDefault();
      var $this   = $(this);
      var $nav    = $this.siblings("nav").length
                  ? $this.siblings("nav")
                  : $this.closest(".elementor-widget-nav-menu").find("nav");
      var $menu   = $nav.find(".elementor-nav-menu");

      var isOpen = $this.hasClass("elementor-active");

      if (isOpen) {
        $this.removeClass("elementor-active").attr("aria-expanded", "false");
        $nav.slideUp(300).removeClass("elementor-nav-menu--dropdown-open");
        $menu.smartmenus("hideAll");
      } else {
        $this.addClass("elementor-active").attr("aria-expanded", "true");
        $nav.slideDown(300).addClass("elementor-nav-menu--dropdown-open");
      }
    });
  }

  /* ================================================================== */
  /*  2. Popup close buttons                                            */
  /* ================================================================== */
  function initPopupCloseButtons() {
    document.addEventListener("click", function (e) {
      var closeBtn = e.target.closest(".elementor-popup-close-button, .dialog-close-button");
      if (!closeBtn) return;

      e.preventDefault();

      var popup = closeBtn.closest(
        ".elementor-popup-modal, .dialog-widget-content, [data-elementor-type='popup']"
      );

      if (popup) {
        popup.style.display = "none";

        /* Also remove any overlay */
        var overlay = popup.querySelector(".dialog-overlay, .elementor-popup__overlay");
        if (overlay) overlay.style.display = "none";

        /* Remove body class that Elementor adds when popup is open */
        document.body.classList.remove("elementor-popup-modal-open");
      }
    });

    /* Close popup when clicking the overlay */
    document.addEventListener("click", function (e) {
      if (!e.target.classList.contains("dialog-overlay") &&
          !e.target.classList.contains("elementor-popup__overlay")) return;

      var popup = e.target.closest(
        ".elementor-popup-modal, .dialog-widget-content, [data-elementor-type='popup']"
      );
      if (popup) {
        popup.style.display = "none";
        document.body.classList.remove("elementor-popup-modal-open");
      }
    });
  }

  /* ================================================================== */
  /*  3. Static-site form handler                                       */
  /* ================================================================== */
  function initStaticFormHandler() {
    document.addEventListener("submit", function (e) {
      var form = e.target.closest(".elementor-form");
      if (!form) return;

      e.preventDefault();

      /* Disable the submit button so user sees feedback */
      var submitBtn = form.querySelector("[type='submit'], .elementor-button");
      if (submitBtn) {
        submitBtn.disabled = true;
      }

      /* Show a user-friendly message */
      var msgEl = form.querySelector(".elementor-message");
      if (!msgEl) {
        msgEl = document.createElement("div");
        msgEl.className = "elementor-message elementor-message-danger elementor-form-message";
        form.appendChild(msgEl);
      }
      msgEl.textContent = "Form submissions are not available on this static version of the site.";
      msgEl.style.display = "block";
      msgEl.style.marginTop = "10px";
      msgEl.style.padding = "10px";

      /* Re-enable button after a short delay */
      setTimeout(function () {
        if (submitBtn) submitBtn.disabled = false;
      }, 3000);
    });
  }

}();
